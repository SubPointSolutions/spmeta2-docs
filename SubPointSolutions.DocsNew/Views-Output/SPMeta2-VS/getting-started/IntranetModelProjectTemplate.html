<html lang="en"><head>    
    <meta charset="utf-8">
    <!-- TITLE OF SITE -->
    <title>SubPoint Solutions</title>
    <meta name="description" content="We enhance your SharePoint experience with excellent APIs, products, and services">
    <meta name="keywords" content="SharePoint, SharePoint Online, SPMeta2, MetaPack, MetaStudio, provision, sp2013, sp2016, o365">
    <meta name="author" content="SubPoint Solutions">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- FAVICON -->
    <link rel="icon" href="/content/img/favicon/favicon.ico">

    <link rel="stylesheet" href="/content/bootstrap.min.css">
    <link rel="stylesheet" href="/content/icons/icons.min.css">
    <link href="http://fonts.googleapis.com/css?family=raleway:300,400,600,700%7copen+sans:300,400,600,700%7chandlee" rel="stylesheet" target="_blank">

    <link rel="stylesheet" href="/content/style.css">
    <link rel="stylesheet" href="/content/responsive.css">
    <link rel="stylesheet" href="/content/colors/red.css" title="red">
    <link rel="stylesheet" href="/content/sps.web.css">

    <link href="/content/syntaxhighlighter/shcore.css" rel="stylesheet">
    <link href="/content/syntaxhighlighter/shcoredefault.css" rel="stylesheet">

    <link href="/content/sps.docs.css" rel="stylesheet">
    <link href="/content/sps.docs.new.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
        <script src="assets/js/plugins/html5shiv.min.js"></script>
        <script src="assets/js/plugins/respond.min.js"></script>
    <![endif]-->
<style>
    .header .overlay {
        height: 500px;
    }

    .company-stat {
        text-align: center;
    }

        .company-stat h4 {
            font-weight: bold;
            color: white;
        }

        .company-stat div.number {
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 60px;
        }

        .company-stat div.fact {
            margin-top: 10px;
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 23px;
        }

    .wrapper-sm-x {
        padding-top: 25px;
        padding-bottom: 10px;
    }

    .header-landing .vmiddle {
        top: 55%;
    }

    .client-logo img {
        max-height: 60px;
        max-width: 140px;
        opacity: 1;
    }

    .client-logo p {
        margin-bottom: 0px;
    }

    .feature-box .description {
        height: 100px;
    }

    p.tweet a {
        color: #c0392b !important;
    }

    .tweet li span {
        font-style: normal !important;
        font-size: 15px;
    }

    p.interact {
        display: none !important;
    }

    pre  {
        background-color:#ffffff;
    }

    .footer-nav {
        margin-top: 0px !important;
    }

</style></head>



<body>
    <div class="main-wrapper">

        



<nav class="navbar navbar-fixed-top is-scrolling" role="navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="navbar-header">
                    <button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
                        <i class="icon icon_menu"></i>
                    </button>

                            <a href="/" class="navbar-brand " title="SmartMvp">
                                <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                                <span class="text-logo">SubPoint Solutions - Docs</span>
                            </a>

                </div>

                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">

                        <li><a href="http://subpointsolutions.com" title="" target="_blank">Home</a></li>

                        
                        <li><a href="http://docs.subpointsolutions.com" title="" target="_blank">Docs</a></li>
                        
                        
                        <li><a href="https://www.yammer.com/spmeta2feedback/" title="" target="_blank">Community</a></li>
                        <li><a href="http://subpointsolutions.com/company" title="" target="_blank">About</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<div class="container body-content sd-body-content">

    <div class="row sps-secondnav">
        



<div class="sub-nav" m-current-subfolder="getting-started">



    <h2>
            <a href="/spmeta2-vs/getting-started/index.html">
                Getting started
            </a> <span>-</span> <span style="font-size: 18px;">Intranet Model Project Template</span>
        
    </h2>

    <ul>
            <li>
                <a m-subgroup="" class="" href="/spmeta2-vs/index.html">
                    M2 VS Extensions Home
                </a>
            </li>
            <li>
                <a m-subgroup="getting-started" class="active" href="/spmeta2-vs/getting-started/index.html">
                    Getting started
                </a>
            </li>

    </ul>
</div>
    </div>

    <div class="row">

        <div class="col-lg-3 col-md-3 col-sm-3 sps-sidebar">
            

<div class="sd-sidebar panel panel-default hidden-print hidden-xs hidden-sm affix1">
    <ul class="nav ">
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/index.html">
                                Getting started
                            </a>
                        </li>
                        <li class="root active">

                            <a href="/spmeta2-vs/getting-started/intranetmodelprojecttemplate.html">
                                Intranet Model Project Template
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/consoleprovisionprojecttemplate.html">
                                Console App Provision Project Template
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/snippets.html">
                                Snippets
                            </a>
                        </li>

    </ul>



</div>
        </div>

        <div class="col-lg-9 col-md-9 col-sm-9 sps-document">
            

<style>
    /*h3 {
        text-align: center;
    }*/
</style><h2>Getting started with M2 VS Intranet Model project</h2>
<p>The current document describes general concepts, guidelines and recommendation on building SharePoint solutions with the SPMeta2 library. It is crafted based on both SPMeta Dev team experience on building M2 library, supporting companies all over the world and client's feedback as such. Hence, it should be considered not only as a jump start guide but also as a production ready approach on building M2 solutions.</p>
<p>The target audience is .NET developers, team leads and software architects who are familiar with POCOs, fluent API, DSL, CI/ALM and seeking guides on he following areas:</p>
<ul>
<li>Overview of SPMeta2 project templates</li>
<li>SPMeta2 Intranet Model project template</li>
<li>SPMeta2 Provision Console project template</li>
<li>Snippets</li>
</ul>
<p>Altogether the document provides a high-level overview of building highly scalable, repeatable and easy-to-maintain projects on top of SPMeta2 library for SharePoint 2013 and O365 using both CSOM/SSOM.</p>
<p>Before continue, please get familiar with the following <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a>, so that it would be much easier to get into the project template details.</p>
<h3>Overview of SPMeta2 project templates</h3>
<p>Visual Studio project templates provide a consistent and reusable way to bootstrap projects and its structure in a few click away.</p>
<p><a href="%22https://github.com/SubPointSolutions/spmeta2-vsixextensions%22">SPMeta2 Extensions for Visual Studio</a> contains a few pre-defined project templates for 'Intranet Model' and 'Console Provision' project creation. That simplifies initial project setup, creates recommended folder structure, initial files and classes as per the suggestions in the <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a> document.</p>
<img src="_img/m2newprojectwizard.png" class=" img-thumbnail img-responsive">
<p>In nutshell, here is a general idea of the project separation and responsibilities:</p>
<ul>
<li>'Intranet Model' - contains 'WHAT TO PROVISION STUFF' - SharePoint artifacts'</li>
<li>'Console App Provision' - contains 'HOW TO PROVISION' - with CSOM/SSOM or somehow else</li>
</ul>
<h3>SPMeta2 Intranet Model project template</h3>
<p>This template bootstraps a new .NET library with predefined folder structure, files and classed described in <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a> document. The project houses the following artifacts and responsibilities:</p>
<ul>
<li>Definitions  - simple saying, SharePoint artifact such as fields, content types, etc...</li>
<li>Models - same artifact that are grouped together into local pieces, models</li>
</ul>
<img src="_img/m2modelprojectexpanded.png" class=" img-thumbnail img-responsive">
<p>Depending on the case, you might keep that project a pure .NET library with SPMeta2 POCO classes only, so that you can reuse it later within CSOM or SSOM based provision, or you might include a provision logic (ProvisionService) inside that project, so that you will have a dependency on a specific SharePoint runtime.</p>
<p>Once creating a project based on this template, you will be required to provide a project name and location, and then you will be asked to provide project specific settings as per the following screen:</p>
<img src="_img/m2newprojectwizard.runtime.png" class=" img-thumbnail img-responsive">
<p>Here are mode details on the settings:</p>
<p>|Parameter Name  	|  Sample value	|  Description |
|-------------	|-------------	|-------------	|
|Project prefix  	|   'MyInt'	| That value will be used as a prefix for some files and classed during the project generation. Please refer to <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a> for mode details.|
|Site fields group | _MyIntantet | That value will be used as a 'Group' property for all fields. Can be changed later.|
|Content types group | _MyIntantet | That value will be used as a 'Group' property for all content types. Can be changed later.|
|Target platform edition | as per choices | That options suggests which NuGet packages and assemblies to add to your projects. Foundation won't add 'SPMeta2.Standard' packages and will skip all additional SharePoint assemblies. Most of the case you have at least SharePoint Standard / O365, so go with 'Standard'|
|Target provision runtime | as per choices  |  use 'POCOs only' options if you want to eliminate SharePoint runtime dependency, overwise pick the right one for you|</p>
<p>Once set up, the project will have the following folder structure. Details on that can be found in <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a>.</p>
<p>The pre-generated project has a bunch of the artifacts defined plus two models - site model and root web model. Once you setup and hit deploy, that's what is going to be provisioned for you by default at site ad root web levels:'</p>
<h5>Site level, MySiteModel</h5>
<ul>
<li>Enabling site feature 'BasicWebParts' from MySiteFeatures</li>
<li>Adding User Custom Action to deploy jQuery from MyUserCustomActions</li>
<li>Adding User Custom Action to deploy custom js script from MyUserCustomActions</li>
<li>Adding 2 (all) security group from MySecurityGroups</li>
<li>Adding 2 (all) security roles defined in MySecurityRoles</li>
<li>Adding 10 (all) site fields form MyFields</li>
<li>Adding 6 content types from MyContentTypes, with linking to the fields</li>
</ul>
<h5>Root web level, MyRootWebModel</h5>
<ul>
<li>Disabiling 'MDS' web feature</li>
<li>Enabling 'Team Collabration Lists' web feature</li>
<li>Enabling 'Wiki Page Home' web feature</li>
<li>Adding 4 top navigatino nodes</li>
<li>Adding 6 quick navigation nodes</li>
<li>Adding document libraries
<ul>
<li>Company Documents</li>
<li>Orders</li>
</ul>
</li>
<li>Adding lists
<ul>
<li>Services</li>
<li>Sales Tasks (task list with hierarhy)</li>
<li>Sales Events (calendar list)</li>
</ul>
</li>
<li>Adding various content types to the mentioned early lists</li>
<li>Adding various list views to the mentioned lists</li>
<li>Setting up default content type in the mentioned lists</li>
<li>Adding two web part pages to the 'Site Pages' library
<ul>
<li>Landing Page</li>
<li>About This Site page</li>
</ul>
</li>
<li>Adding XsltListView, ListView, ContentEditor web parts to 'Landing Page' page</li>
<li>Adding ContentEditor web parts to 'About This Site' page</li>
<li>Setting up 'Landing Page' as a welcome, default landing page of the web</li>
<li>Uploading all content from /Modules/Implicit/Style Library to SharePoint's Style Library</li>
</ul>
<p>All these artifacts are defined in multiple classes under /Definitions folders and then put together within MySiteModel and MyRootWebModel under /Models folders.</p>
<p>At this stage we setup a nice and fully repeatable intranet project showing up a very basics of the SPMeta2 library, definitions, and models.</p>
<h4>Provision</h4>
<p><strong>If you set a particular SharePoint provision runtime</strong> while creating the projects, then you will have a pre-generated provision class under /Service folder. It has two methods to provision either 'everything' or just 'some bits' of the whole model as following:</p>
<pre><code class="language-cs">public void DeployIntranet(ClientContext context)
public void DeployIntranet(ClientContext context, Options options)
</code></pre>
<p>To get things provisioned, create a new console application or unit test, create a new ClientContents (or SPSite) object and then pass it to DeployIntranet(ClientContext context) methods. That's CSOM based provision, in case you selected SSOM, you will have SPSite object as a parameter for DeployIntranet() method. Have a look, dig into the source code.</p>
<p><strong>If you have not set a SharePoint provision runtime</strong> and went with the plain POCOs, then create a new console application or unit test, create a new ClientContents (or SPSite) object and then use the following snippet as a jump-started:</p>
<pre><code class="language-cs">// create correct provision service
// SharePoint Foundation: CSOMProvisionService / SSOMProvisionService
// SharePoint Standard: StandardCSOMProvisionService / StandardSSOMProvisionService
var provisionService = new CSOMProvisionService(); 

// create models
var siteModel = new IntrSiteModel();
var rootWebModel = new IntrRootWebModel();

// .. get the SharePoint context here, as context

// site model
provisionService.DeploySiteModel(context, siteModel.GetSiteFeaturesModel());
provisionService.DeploySiteModel(context, siteModel.GetUserCustomActionModel());
provisionService.DeploySiteModel(context, siteModel.GetSiteSecurityModel());

provisionService.DeploySiteModel(context, siteModel.GetFieldsAndContentTypesModel());
provisionService.DeploySiteModel(context, siteModel.GetSandboxSolutionsModel());

// root web model
provisionService.DeployWebModel(context, rootWebModel.GetStyleLibraryModel());
provisionService.DeployWebModel(context, rootWebModel.GetModel());

</code></pre>
<p>Use the following services as per correct SharePoint edition:</p>
<ul>
<li>SharePoint Foundation: CSOMProvisionService / SSOMProvisionService</li>
<li>SharePoint Standard: StandardCSOMProvisionService / StandardSSOMProvisionService</li>
</ul>
<p>Once all setup, here is a your first, fantastic, ready-to-use SharePoint Intranet build on top of SPMeta2. Enjoy!</p>
<img src="_img/m2.myintranet.full.png" class=" img-thumbnail img-responsive">



            

    <div class="m-prevNextNav-cnt">
            <a class="btn-lg btn-default m-btn-prev" href="/spmeta2-vs/getting-started/index.html">
                <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span> Previous
            </a>
                    <a class="btn-lg btn-default pull-right m-btn-next" href="/spmeta2-vs/getting-started/consoleprovisionprojecttemplate.html">
                Next <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
            </a>
    </div>

        </div>

        

    </div>
</div>


        <footer class="footer dark-bg" id="footer">
    <div class="container">
        <div class="wrapper-lg">
            <div class="row">
                <!-- Footer Left Col -->
                <div class="col-md-4">
                    <!-- Logo -->


                    <h5 class="text-white">
                        <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                        SubPoint Solutions
                    </h5>

                    <p class="footer-hero">
                        Enhancing your SharePoint experience with excellent APIs, products, and services so that you can focus on business-critical tasks.
                        Recognized and trusted since 2013.
                    </p>
                </div>
                <!-- Footer Contact Col -->
                <div class="col-md-4">
                    <h5 class="text-white">Our Contacts</h5>
                    <div class="contact-item">
                        <div class="contact-content">
                            Email:<br>
                            <a style="font-size: 14px;" href="mailto:support@subpointsolutions.com">support@subpointsolutions.com</a>
                        </div>

                        <div class="contact-content">
                            Yammer Network:<br>
                            <a style="font-size: 14px;" href="https://www.yammer.com/spmeta2feedback" target="_blank">https://www.yammer.com/spmeta2feedback</a>
                        </div>


                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="icon icon_pin"></i>
                        </div>
                        <div class="contact-content">
                            Sydney, NSW 2000 Australia
                        </div>
                    </div>
                </div>
                <!-- Footer Right Col: Twitter Feed -->
                <div class="col-md-4">
                    <h5 class="text-white">Recent Tweets</h5>

                    <div class="tweet" id="twitter-cnt">

                    </div>
                </div>

                <!-- Footer Menu and Copy -->
               
            </div>

            <div class="row">
                <div class="col-md-12">
                    <ul class="footer-nav">
                        <li>
                            <a href="/company">Company</a>
                        </li>
                        
                        <li>
                            <a href="/terms">Terms Of Use</a>
                        </li>
                        <li>
                            <a href="/privacy">Privacy Policy</a>
                        </li>
                    </ul>
                    <p class="footer-copy">

                        Copyright © <a hre="http://subpointsolutions.com" target="_blank">SubPoint Solutions</a> 2017. 
                        Built with care, <a href="http://wyam.io" target="_blank">Wyam</a> and <a href="https://www.netlify.com/" target="_blank">Netlify</a>. Last updated Sun, 30 Apr 2017 21:59:18 GMT.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

    </div>

    <script src="/scripts/jquery-1.9.1.min.js"></script>
    <script src="/scripts/bootstrap.js"></script>

    <script src="/scripts/syntaxhighlighter/shcore.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushcsharp.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushxml.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushjscript.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushpowershell.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script>


    

    


    <script>

        (function ($) {

            $(document).ready(function () {

                $('code.language-cs')
                    .addClass('brush: csharp;');

                $('code.language-xml')
                    .addClass('brush: xml;');

                $('code.language-js')
                    .addClass('brush: js;');
                    
                $('code.language-ps')
                       .addClass('brush: ps;');

                SyntaxHighlighter.defaults['quick-code'] = false;
                SyntaxHighlighter.config.tagName = 'code';
                SyntaxHighlighter.all();
            });

            $(document).ready(function () {
                $("body").bind("keydown", function (event) {

                    console.log(event);

                    if (event.ctrlKey && event.keyCode == 37) {

                        if ($('a.m-btn-prev').size() > 0) {
                            var href = $('a.m-btn-prev').attr('href');

                            window.location.href = href;
                        }
                    }

                    if (event.ctrlKey && event.keyCode == 39) {
                        if ($('a.m-btn-next').size() > 0) {
                            var href = $('a.m-btn-next').attr('href');

                            window.location.href = href;
                        }
                    }
                });
            });

        }(jQuery));

    </script>


</body></html>