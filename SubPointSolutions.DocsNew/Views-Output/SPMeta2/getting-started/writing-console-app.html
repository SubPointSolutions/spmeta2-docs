<html lang="en"><head>    
    <meta charset="utf-8">
    <!-- TITLE OF SITE -->
    <title>SubPoint Solutions</title>
    <meta name="description" content="We enhance your SharePoint experience with excellent APIs, products, and services">
    <meta name="keywords" content="SharePoint, SharePoint Online, SPMeta2, MetaPack, MetaStudio, provision, sp2013, sp2016, o365">
    <meta name="author" content="SubPoint Solutions">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- FAVICON -->
    <link rel="icon" href="/content/img/favicon/favicon.ico">

    <link rel="stylesheet" href="/content/bootstrap.min.css">
    <link rel="stylesheet" href="/content/icons/icons.min.css">
    <link href="http://fonts.googleapis.com/css?family=raleway:300,400,600,700%7copen+sans:300,400,600,700%7chandlee" rel="stylesheet" target="_blank">

    <link rel="stylesheet" href="/content/style.css">
    <link rel="stylesheet" href="/content/responsive.css">
    <link rel="stylesheet" href="/content/colors/red.css" title="red">
    <link rel="stylesheet" href="/content/sps.web.css">

    <link href="/content/syntaxhighlighter/shcore.css" rel="stylesheet">
    <link href="/content/syntaxhighlighter/shcoredefault.css" rel="stylesheet">

    <link href="/content/sps.docs.css" rel="stylesheet">
    <link href="/content/sps.docs.new.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
        <script src="assets/js/plugins/html5shiv.min.js"></script>
        <script src="assets/js/plugins/respond.min.js"></script>
    <![endif]-->
<style>
    .header .overlay {
        height: 500px;
    }

    .company-stat {
        text-align: center;
    }

        .company-stat h4 {
            font-weight: bold;
            color: white;
        }

        .company-stat div.number {
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 60px;
        }

        .company-stat div.fact {
            margin-top: 10px;
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 23px;
        }

    .wrapper-sm-x {
        padding-top: 25px;
        padding-bottom: 10px;
    }

    .header-landing .vmiddle {
        top: 55%;
    }

    .client-logo img {
        max-height: 60px;
        max-width: 140px;
        opacity: 1;
    }

    .client-logo p {
        margin-bottom: 0px;
    }

    .feature-box .description {
        height: 100px;
    }

    p.tweet a {
        color: #c0392b !important;
    }

    .tweet li span {
        font-style: normal !important;
        font-size: 15px;
    }

    p.interact {
        display: none !important;
    }

    pre  {
        background-color:#ffffff;
    }

    .footer-nav {
        margin-top: 0px !important;
    }

</style></head>



<body>
    <div class="main-wrapper">

        



<nav class="navbar navbar-fixed-top is-scrolling" role="navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="navbar-header">
                    <button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
                        <i class="icon icon_menu"></i>
                    </button>

                            <a href="/" class="navbar-brand " title="SmartMvp">
                                <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                                <span class="text-logo">SubPoint Solutions - Docs</span>
                            </a>

                </div>

                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">

                        <li><a href="http://subpointsolutions.com" title="" target="_blank">Home</a></li>

                        
                        <li><a href="http://docs.subpointsolutions.com" title="" target="_blank">Docs</a></li>
                        
                        
                        <li><a href="https://www.yammer.com/spmeta2feedback/" title="" target="_blank">Community</a></li>
                        <li><a href="http://subpointsolutions.com/company" title="" target="_blank">About</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<div class="container body-content sd-body-content">

    <div class="row sps-secondnav">
        



<div class="sub-nav" m-current-subfolder="getting-started">



    <h2>
            <a href="/spmeta2/getting-started/index.html">
                Getting started
            </a> <span>-</span> <span style="font-size: 18px;">Writing a console app</span>
        
    </h2>

    <ul>
            <li>
                <a m-subgroup="" class="" href="/spmeta2/index.html">
                    SPMeta2 Home
                </a>
            </li>
            <li>
                <a m-subgroup="getting-started" class="active" href="/spmeta2/getting-started/index.html">
                    Getting started
                </a>
            </li>
            <li>
                <a m-subgroup="reference" class="" href="/spmeta2/reference/index.html">
                    Reference
                </a>
            </li>
            <li>
                <a m-subgroup="extensibility" class="" href="/spmeta2/extensibility/index.html">
                    Extensibility
                </a>
            </li>
            <li>
                <a m-subgroup="scenarios" class="" href="/spmeta2/scenarios/index.html">
                    Scenarios
                </a>
            </li>
            <li>
                <a m-subgroup="kb" class="" href="/spmeta2/kb/index.html">
                    KB
                </a>
            </li>

    </ul>
</div>
    </div>

    <div class="row">

        <div class="col-lg-3 col-md-3 col-sm-3 sps-sidebar">
            

<div class="sd-sidebar panel panel-default hidden-print hidden-xs hidden-sm affix1">
    <ul class="nav ">
                        <li class="root">

                            <a href="/spmeta2/getting-started/index.html">
                                Getting started
                            </a>
                        </li>
                        <li class="root active">

                            <a href="/spmeta2/getting-started/writing-console-app.html">
                                Writing a console app
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2/getting-started/license.html">
                                License
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2/getting-started/releases.html">
                                Releases
                            </a>
                        </li>

    </ul>



</div>
        </div>

        <div class="col-lg-9 col-md-9 col-sm-9 sps-document">
            

<style>
    /*h3 {
        text-align: center;
    }*/
</style><h3>Writing a simple console app</h3>
<p>SPMeta2 supports SharePoint 2010, SharePoint 2013 and SharePoint Online.
We use NuGet to deliver all the packages, handle versioning, updates and patches.</p>
<p>This article introduces a NuGet packages description, consuming NuGet packages in your applications and usage of github repository if you like to built SPMeta2 library from scratch.</p>
<h3>Referencing SPMeta2 from NuGet</h3>
<p>The easiest way to start with SPMeta library is to use NuGet packages. We support a range of SharePoint versions - 2010, 2013 and Online as well as CSOM/SSOM, so we have a bunch of the NuGet packages out there.</p>
<h4>The core library</h4>
<ul>
<li><a href="https://www.nuget.org/packages/spmeta2.core/" target="_blank">SPMeta2.Core</a> - contains the core of the library and definitions for SharePoint Foundation</li>
</ul>
<h4>CSOM provision</h4>
<p>CSOM provision (built with SharePoint 2013 onprem v15 assemblies):</p>
<ul>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.foundation/" target="_blank">SPMeta2.CSOM.Foundation</a> - includes CSOM provision implementation for SharePoint Foundation 2013</li>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.standard/" target="_blank">SPMeta2.CSOM.Standard</a> - includes CSOM provision implementation for SharePoint Standard 2013</li>
</ul>
<p>CSOM provision for SharePoint Online (built with SharePoint Online v16 assemblies):</p>
<ul>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.foundation-v16/" target="_blank">SPMeta2.CSOM.Foundation-v16/</a> - includes CSOM provision implementation for SharePoint Online</li>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.standard-v16/" target="_blank">SPMeta2.CSOM.Standard-v16</a> - includes CSOM provision implementation for SharePoint Online</li>
</ul>
<h4>SSOM provision</h4>
<p>SSOM provision for SharePoint 2013 (built with SharePoint 2013 assemblies):</p>
<ul>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.foundation/" target="_blank">SPMeta2.SSOM.Foundation</a> - includes SSOM provision implementation for SharePoint Foundation 2013</li>
<li><a href="https://www.nuget.org/packages/spmeta2.csom.standard/" target="_blank">SPMeta2.SSOM.Standard</a> - includes SSOM provision implementation for SharePoint Standard 2013</li>
</ul>
<p>SSOM provision for SharePoint 2010 (built with SharePoint 2010 assemblies):</p>
<ul>
<li><a href="https://www.nuget.org/packages/spmeta2.ssom.foundation-v14/" target="_blank">SPMeta2.SSOM.Foundation-v14</a> - includes SSOM provision implementation for SharePoint Foundation 2010</li>
<li><a href="https://www.nuget.org/packages/spmeta2.ssom.standard-v14/" target="_blank">SPMeta2.SSOM.Standard-v14</a> - includes SSOM provision implementation for SharePoint Standard 2010</li>
</ul>
<h3>Building SPMeta2 from the source code</h3>
<p>The other options you might consider is to use SPMeta2 github repository and built the library from scratch. Although it is not a recommended options, but still possible one.</p>
<p>Here are a few links to get started:</p>
<ul>
<li><a href="https://github.com/subpointsolutions/spmeta2" target="_blank">SPMeta2 library @ GITHUB</a></li>
<li><a href="https://github.com/subpointsolutions/spmeta2.git" target="_blank">HTTPS clone URL - https://github.com/SubPointSolutions/spmeta2.git</a></li>
</ul>
<p>One you have SPMeta2 solutions up and running, you can either build it with Visual Studio 2013 or use "build.ps1" script located in /SPMeta2/SPMeta2.Build folder.</p>
<h3>Creating a simple CSOM application for SharePoint 2013</h3>
<p>Let's get started and create a simple console application which provisions a few fields and a content type on a target SharePoint site.</p>
<p>As we target SharePoint 2013, we would need to use <a href="https://www.nuget.org/packages/spmeta2.csom.foundation/" target="_blank">SPMeta2.CSOM.Foundation</a> package.
Here are detailed steps to get startes:</p>
<h4>Step 1, bootstrap a console application project</h4>
<p>Start your Visual Studio and bootstrap a simple console application:</p>
<p><img src="_img/1-new-console-app.png" alt="" class=" img-thumbnail img-responsive"></p>
<h4>Step 2, use NuGet to get <a href="https://www.nuget.org/packages/spmeta2.csom.foundation/" target="_blank">SPMeta2.CSOM.Foundation</a> package.</h4>
<p>Simple use NuGet package manager to find and install <a href="https://www.nuget.org/packages/spmeta2.csom.foundation/" target="_blank">SPMeta2.CSOM.Foundation</a> package or use the following command in the "Package Manager Console":</p>
<ul>
<li>install-package SPMeta2.CSOM.Foundation</li>
</ul>
<h4>Step 3, setup your definitions, model and provision service</h4>
<p>There are a few outtanding things we need to complete - create definitions, setup relationships between them and, finally, push the model to the SharePoint site.</p>
<p>Include the following code in your console application changing the 'siteUrl', run it and enjoy the outcome.</p>
<pre><code class="language-cs">
var siteUrl = "http://tesla-dev:31415/";


// define fields
var clientDescriptionField = new FieldDefinition
{
    Title = "Client Description",
    InternalName = "dcs_ClientDescription",
    Group = "SPMeta2.Samples",
    Id = new Guid("06975b67-01f5-47d7-9e2e-2702dfb8c217"),
    FieldType = BuiltInFieldTypes.Note,
};

var clientNumberField = new FieldDefinition
{
    Title = "Client Number",
    InternalName = "dcs_ClientNumber",
    Group = "SPMeta2.Samples",
    Id = new Guid("22264486-7561-45ec-a6bc-591ba243693b"),
    FieldType = BuiltInFieldTypes.Number,
};


// define content type
var customerAccountContentType = new ContentTypeDefinition
{
    Name = "Customer Account",
    Id = new Guid("ddc46a66-19a0-460b-a723-c84d7f60a342"),
    ParentContentTypeId = BuiltInContentTypeId.Item,
    Group = "SPMeta2.Samples",
};

// define relationships and the model
var siteModel = SPMeta2Model.NewSiteModel(site =&gt;
{
    site
        .AddField(clientDescriptionField)
        .AddField(clientNumberField)
        .AddContentType(customerAccountContentType, contentType =&gt;
        {
            contentType
                .AddContentTypeFieldLink(clientDescriptionField)
                .AddContentTypeFieldLink(clientNumberField);
        });
});

var clientContext = new ClientContext(siteUrl);

// deploy the model to the SharePoint site over CSOM
var csomProvisionService = new CSOMProvisionService();
csomProvisionService.DeploySiteModel(clientContext, siteModel);


</code></pre>
<h3>Creating a simple SSOM application for SharePoint 2013</h3>
<p>Essentially, we would need to bootstrap the same console application (check previous CSOM application) and add <a href="https://www.nuget.org/packages/spmeta2.ssom.foundation/" target="_blank">SPMeta2.SSOM.Foundation</a> package or use the following command in the "Package Manager Console":</p>
<ul>
<li>install-package SPMeta2.SSOM.Foundation</li>
</ul>
<p>The actual code will be the same, but to enable SSOM based provision we need to use 'CSOMProvisionService'. Include the following code in your console application changing the 'siteUrl', run it and enjoy the outcome.</p>
<pre><code class="language-cs">
var siteUrl = "http://tesla-dev:31415/";

// define fields
var clientDescriptionField = new FieldDefinition
{
    Title = "Client Description",
    InternalName = "dcs_ClientDescription",
    Group = "SPMeta2.Samples",
    Id = new Guid("06975b67-01f5-47d7-9e2e-2702dfb8c217"),
    FieldType = BuiltInFieldTypes.Note,
};

var clientNumberField = new FieldDefinition
{
    Title = "Client Number",
    InternalName = "dcs_ClientNumber",
    Group = "SPMeta2.Samples",
    Id = new Guid("22264486-7561-45ec-a6bc-591ba243693b"),
    FieldType = BuiltInFieldTypes.Number,
};


// define content type
var customerAccountContentType = new ContentTypeDefinition
{
    Name = "Customer Account",
    Id = new Guid("ddc46a66-19a0-460b-a723-c84d7f60a342"),
    ParentContentTypeId = BuiltInContentTypeId.Item,
    Group = "SPMeta2.Samples",
};

// define relationships and the model
var siteModel = SPMeta2Model.NewSiteModel(site =&gt;
{
    site
        .AddField(clientDescriptionField)
        .AddField(clientNumberField)
        .AddContentType(customerAccountContentType, contentType =&gt;
        {
            contentType
                .AddContentTypeFieldLink(clientDescriptionField)
                .AddContentTypeFieldLink(clientNumberField);
        });
});

using (var spSite = new SPSite(siteUrl))
{
    // deploy the model to the SharePoint site over CSOM
    var ssomProvisionService = new SSOMProvisionService();
    ssomProvisionService.DeploySiteModel(spSite, siteModel);
}


</code></pre>



            

    <div class="m-prevNextNav-cnt">
            <a class="btn-lg btn-default m-btn-prev" href="/spmeta2/getting-started/index.html">
                <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span> Previous
            </a>
                    <a class="btn-lg btn-default pull-right m-btn-next" href="/spmeta2/getting-started/license.html">
                Next <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
            </a>
    </div>

        </div>

        

    </div>
</div>


        <footer class="footer dark-bg" id="footer">
    <div class="container">
        <div class="wrapper-lg">
            <div class="row">
                <!-- Footer Left Col -->
                <div class="col-md-4">
                    <!-- Logo -->


                    <h5 class="text-white">
                        <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                        SubPoint Solutions
                    </h5>

                    <p class="footer-hero">
                        Enhancing your SharePoint experience with excellent APIs, products, and services so that you can focus on business-critical tasks.
                        Recognized and trusted since 2013.
                    </p>
                </div>
                <!-- Footer Contact Col -->
                <div class="col-md-4">
                    <h5 class="text-white">Our Contacts</h5>
                    <div class="contact-item">
                        <div class="contact-content">
                            Email:<br>
                            <a style="font-size: 14px;" href="mailto:support@subpointsolutions.com">support@subpointsolutions.com</a>
                        </div>

                        <div class="contact-content">
                            Yammer Network:<br>
                            <a style="font-size: 14px;" href="https://www.yammer.com/spmeta2feedback" target="_blank">https://www.yammer.com/spmeta2feedback</a>
                        </div>


                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="icon icon_pin"></i>
                        </div>
                        <div class="contact-content">
                            Sydney, NSW 2000 Australia
                        </div>
                    </div>
                </div>
                <!-- Footer Right Col: Twitter Feed -->
                <div class="col-md-4">
                    <h5 class="text-white">Recent Tweets</h5>

                    <div class="tweet" id="twitter-cnt">

                    </div>
                </div>

                <!-- Footer Menu and Copy -->
               
            </div>

            <div class="row">
                <div class="col-md-12">
                    <ul class="footer-nav">
                        <li>
                            <a href="/company">Company</a>
                        </li>
                        
                        <li>
                            <a href="/terms">Terms Of Use</a>
                        </li>
                        <li>
                            <a href="/privacy">Privacy Policy</a>
                        </li>
                    </ul>
                    <p class="footer-copy">

                        Copyright © <a hre="http://subpointsolutions.com" target="_blank">SubPoint Solutions</a> 2017. 
                        Built with care, <a href="http://wyam.io" target="_blank">Wyam</a> and <a href="https://www.netlify.com/" target="_blank">Netlify</a>. Last updated Sun, 30 Apr 2017 21:59:18 GMT.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

    </div>

    <script src="/scripts/jquery-1.9.1.min.js"></script>
    <script src="/scripts/bootstrap.js"></script>

    <script src="/scripts/syntaxhighlighter/shcore.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushcsharp.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushxml.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushjscript.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushpowershell.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script>


    

    


    <script>

        (function ($) {

            $(document).ready(function () {

                $('code.language-cs')
                    .addClass('brush: csharp;');

                $('code.language-xml')
                    .addClass('brush: xml;');

                $('code.language-js')
                    .addClass('brush: js;');
                    
                $('code.language-ps')
                       .addClass('brush: ps;');

                SyntaxHighlighter.defaults['quick-code'] = false;
                SyntaxHighlighter.config.tagName = 'code';
                SyntaxHighlighter.all();
            });

            $(document).ready(function () {
                $("body").bind("keydown", function (event) {

                    console.log(event);

                    if (event.ctrlKey && event.keyCode == 37) {

                        if ($('a.m-btn-prev').size() > 0) {
                            var href = $('a.m-btn-prev').attr('href');

                            window.location.href = href;
                        }
                    }

                    if (event.ctrlKey && event.keyCode == 39) {
                        if ($('a.m-btn-next').size() > 0) {
                            var href = $('a.m-btn-next').attr('href');

                            window.location.href = href;
                        }
                    }
                });
            });

        }(jQuery));

    </script>


</body></html>