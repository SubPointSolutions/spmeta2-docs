<html lang="en"><head>    
    <meta charset="utf-8">
    <!-- TITLE OF SITE -->
    <title>SubPoint Solutions</title>
    <meta name="description" content="We enhance your SharePoint experience with excellent APIs, products, and services">
    <meta name="keywords" content="SharePoint, SharePoint Online, SPMeta2, MetaPack, MetaStudio, provision, sp2013, sp2016, o365">
    <meta name="author" content="SubPoint Solutions">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- FAVICON -->
    <link rel="icon" href="/content/img/favicon/favicon.ico">

    <link rel="stylesheet" href="/content/bootstrap.min.css">
    <link rel="stylesheet" href="/content/icons/icons.min.css">
    <link href="http://fonts.googleapis.com/css?family=raleway:300,400,600,700%7copen+sans:300,400,600,700%7chandlee" rel="stylesheet" target="_blank">

    <link rel="stylesheet" href="/content/style.css">
    <link rel="stylesheet" href="/content/responsive.css">
    <link rel="stylesheet" href="/content/colors/red.css" title="red">
    <link rel="stylesheet" href="/content/sps.web.css">

    <link href="/content/syntaxhighlighter/shcore.css" rel="stylesheet">
    <link href="/content/syntaxhighlighter/shcoredefault.css" rel="stylesheet">

    <link href="/content/sps.docs.css" rel="stylesheet">
    <link href="/content/sps.docs.new.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
        <script src="assets/js/plugins/html5shiv.min.js"></script>
        <script src="assets/js/plugins/respond.min.js"></script>
    <![endif]-->
<style>
    .header .overlay {
        height: 500px;
    }

    .company-stat {
        text-align: center;
    }

        .company-stat h4 {
            font-weight: bold;
            color: white;
        }

        .company-stat div.number {
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 60px;
        }

        .company-stat div.fact {
            margin-top: 10px;
            color: white;
            font-weight: bold;
            font-style: normal;
            font-size: 23px;
        }

    .wrapper-sm-x {
        padding-top: 25px;
        padding-bottom: 10px;
    }

    .header-landing .vmiddle {
        top: 55%;
    }

    .client-logo img {
        max-height: 60px;
        max-width: 140px;
        opacity: 1;
    }

    .client-logo p {
        margin-bottom: 0px;
    }

    .feature-box .description {
        height: 100px;
    }

    p.tweet a {
        color: #c0392b !important;
    }

    .tweet li span {
        font-style: normal !important;
        font-size: 15px;
    }

    p.interact {
        display: none !important;
    }

    pre  {
        background-color:#ffffff;
    }

    .footer-nav {
        margin-top: 0px !important;
    }

</style></head>



<body>
    <div class="main-wrapper">

        



<nav class="navbar navbar-fixed-top is-scrolling" role="navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="navbar-header">
                    <button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
                        <i class="icon icon_menu"></i>
                    </button>

                            <a href="/" class="navbar-brand " title="SmartMvp">
                                <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                                <span class="text-logo">SubPoint Solutions - Docs</span>
                            </a>

                </div>

                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">

                        <li><a href="http://subpointsolutions.com" title="" target="_blank">Home</a></li>

                        
                        <li><a href="http://docs.subpointsolutions.com" title="" target="_blank">Docs</a></li>
                        
                        
                        <li><a href="https://www.yammer.com/spmeta2feedback/" title="" target="_blank">Community</a></li>
                        <li><a href="http://subpointsolutions.com/company" title="" target="_blank">About</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<div class="container body-content sd-body-content">

    <div class="row sps-secondnav">
        



<div class="sub-nav" m-current-subfolder="getting-started">



    <h2>
            <a href="/spmeta2-vs/getting-started/index.html">
                Getting started
            </a> <span>-</span> <span style="font-size: 18px;">Console App Provision Project Template</span>
        
    </h2>

    <ul>
            <li>
                <a m-subgroup="" class="" href="/spmeta2-vs/index.html">
                    M2 VS Extensions Home
                </a>
            </li>
            <li>
                <a m-subgroup="getting-started" class="active" href="/spmeta2-vs/getting-started/index.html">
                    Getting started
                </a>
            </li>

    </ul>
</div>
    </div>

    <div class="row">

        <div class="col-lg-3 col-md-3 col-sm-3 sps-sidebar">
            

<div class="sd-sidebar panel panel-default hidden-print hidden-xs hidden-sm affix1">
    <ul class="nav ">
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/index.html">
                                Getting started
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/intranetmodelprojecttemplate.html">
                                Intranet Model Project Template
                            </a>
                        </li>
                        <li class="root active">

                            <a href="/spmeta2-vs/getting-started/consoleprovisionprojecttemplate.html">
                                Console App Provision Project Template
                            </a>
                        </li>
                        <li class="root">

                            <a href="/spmeta2-vs/getting-started/snippets.html">
                                Snippets
                            </a>
                        </li>

    </ul>



</div>
        </div>

        <div class="col-lg-9 col-md-9 col-sm-9 sps-document">
            

<style>
    /*h3 {
        text-align: center;
    }*/
</style><h2>Getting started with M2 VS Console provision project</h2>
<p>The current document describes general concepts, guidelines and recommendation on building SharePoint solutions with the SPMeta2 library. It is crafted based on both SPMeta Dev team experience on building M2 library, supporting companies all over the world and client's feedback as such. Hence, it should be considered not only as a jump start guide but also as a production ready approach on building M2 solutions.</p>
<p>The target audience is .NET developers, team leads and software architects who are familiar with POCOs, fluent API, DSL, CI/ALM and seeking guides on he following areas:</p>
<ul>
<li>Overview of SPMeta2 project templates</li>
<li>SPMeta2 Intranet Model project template</li>
<li>SPMeta2 Provision Console project template</li>
<li>Snippets</li>
</ul>
<p>Altogether the document provides a high-level overview of building highly scalable, repeatable and easy-to-maintain projects on top of SPMeta2 library for SharePoint 2013 and O365 using both CSOM/SSOM.</p>
<p>Before continue, please get familiar with the following <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a>, so that it would be much easier to get into the project template details.</p>
<h3>Overview of SPMeta2 project templates</h3>
<p>Visual Studio project templates provide a consistent and reusable way to bootstrap projects and its structure in a few click away.</p>
<p><a href="%22https://github.com/SubPointSolutions/spmeta2-vsixextensions%22">SPMeta2 Extensions for Visual Studio</a> contains a few pre-defined project templates for 'Intranet Model' and 'Console Provision' project creation. That simplifies initial project setup, creates recommended folder structure, initial files and classes as per the suggestions in the <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a> document.</p>
<img src="_img/m2newprojectwizard.png" class=" img-thumbnail img-responsive">
<p>In nutshell, here is a general idea of the project separation and responsibilities:</p>
<ul>
<li>'Intranet Model' - contains 'WHAT TO PROVISION STUFF' - SharePoint artifacts'</li>
<li>'Console App Provision' - contains 'HOW TO PROVISION' - with CSOM/SSOM or somehow else</li>
</ul>
<h3>SPMeta2 Console Provision project template</h3>
<p>This template bootstraps a new .NET console application with a few predefined classed and code snippets. The project is aimed to provide a jump start for a simple console provision of the SPMeta2 based models. Refer to <a href="https://github.com/subpointsolutions/spmeta2-vsixextensions/wiki/general-concepts" target="_blank">General concepts</a> document for the more context and information about definitions, models and provision services.</p>
<img src="_img/m2console.newproject.png" class=" img-thumbnail img-responsive">
<p>Once creating a project based on this template, you will be required to provide a project name and location and then, similarly to 'SPMeta2 Intranet Model' template, a target SharePoint runtime as per the following screen:
<img src="_img/m2console.wizard.png" class=" img-thumbnail img-responsive"></p>
<p>Here are mode details on the settings:</p>
<p>|Parameter Name  	|  Sample value	|  Description |
|-------------	|-------------	|-------------	|
|Target platform edition | as per choices | That options suggests which NuGet packages and assemblies to add to your projects. Foundation won't add 'SPMeta2.Standard' packages and will skip all additional SharePoint assemblies. Most of the case you have at least SharePoint Standard / O365, so go with 'Standard'|
|Target provision runtime | as per choices  |  use 'POCOs only' options if you want to eliminate SharePoint runtime dependency, overwise pick the right one for you|
Once set up, the project will have the following folder structure and a pre-generated classes:</p>
<img src="_img/m2console.projectstructure.png" class=" img-thumbnail img-responsive">
<p>The pre-generated project has the following folders, files and classed predefined:</p>
<p><strong>Folders</strong></p>
<ul>
<li>/PSScripts - put your scripts here, as you need them</li>
<li>/Utils - houses usefule project specific utils</li>
</ul>
<p><strong>Classes</strong></p>
<ul>
<li>ConsoleUtils</li>
<li>partial CSOMConsoleUtils, SSOMConsoleUtils or O365ConsoleUtils</li>
</ul>
<p>The following programme is pre-generated to bootstrap the provision. Default "http://portal" url is used as a target site collection so that it works well with SPAutoInstaller.</p>
<pre><code class="language-cs">static void Main(string[] args)
        {
            var siteUrl = "http://portal";
            var consoleUtils = new ConsoleUtils();

            consoleUtils.WithCSOMContext(siteUrl, context =&gt;
            {
                // replace it with your M2 models
                var siteModel = default(ModelNode);
                var rotWebModel = default(ModelNode);

                // create a provision service - CSOMProvisionService or StandardCSOMProvisionService
                var provisionService = new CSOMProvisionService();

                // little nice thing, tracing the progress
                consoleUtils.TraceDeploymentProgress(provisionService);

                // deploy!
                provisionService.DeploySiteModel(context, siteModel);
                provisionService.DeployWebModel(context, rotWebModel);
            });
        }
</code></pre>
<p>Depending on the SharePoint provision runtime you selected early, the ConsoleUtils class will have WithXXX() methods such as following:</p>
<ul>
<li>WithO365Context()</li>
<li>WithCSOMContext()</li>
<li>WithSSOMContext()</li>
</ul>
<h4>Console app configuration and tracing</h4>
<p>The console application comes with a pre-generated app.config file. We update two sections to add SPMeta2 tracing to the console and the log file as well as add some app-level setting.</p>
<p>By default, SPMeta2 uses the standard .NET trace listeners infrastructure with the source name "SPMeta2", so that the following diagnostic sources config can be used as a jump starter. Default level is 'Information' which is more than enough to see the progress in the console application.</p>
<pre><code class="language-xml">&lt;system.diagnostics&gt;
    &lt;sources&gt;
      &lt;!-- SPMeta2 logging --&gt;
      &lt;source name="SPMeta2" switchName="sourceSwitch" switchType="System.Diagnostics.SourceSwitch"&gt;
        &lt;listeners&gt;
          &lt;add name="SPMeta2.ConsoleLog" type="System.Diagnostics.ConsoleTraceListener"&gt;
          &lt;/add&gt;
          &lt;add name="SPMeta2.DelimitedLog" type="System.Diagnostics.DelimitedListTraceListener" delimiter=":" initializeData="spmeta2.delimited.txt" traceOutputOptions="ProcessId, DateTime, Timestamp" /&gt;
          &lt;!--
          &lt;add name="SPMeta2.TextLog"
               traceOutputOptions="Timestamp"
               type="System.Diagnostics.TextWriterTraceListener"
               initializeData="spmeta2.log"&gt;
          &lt;/add&gt;
          &lt;add name="SPMeta2.XmlLog"
               type="System.Diagnostics.XmlWriterTraceListener"
               initializeData="spmeta2.xml.log"
               traceOutputOptions="ProcessId, DateTime, Timestamp" /&gt;
          &lt;add name="SPMeta2.WebPageLog"
               type="System.Web.WebPageTraceListener, System.Web, Version=2.0.3600.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /&gt;
           --&gt;
        &lt;/listeners&gt;
      &lt;/source&gt;
    &lt;/sources&gt;
    &lt;switches&gt;
      &lt;add name="sourceSwitch" value="Information" /&gt;
    &lt;/switches&gt;
  &lt;/system.diagnostics&gt;
</code></pre>
<p>The app settings are updated with the following values, we aim to use these value to drive the code-based provision of the needed SPMeta2 models or smaller bits:</p>
<pre><code class="language-xml">&lt;appSettings&gt;

    &lt;!-- generic settings START --&gt;
    &lt;add key="IntranetUrl" value="http://portal" /&gt;
    &lt;!-- generic settings END --&gt;

    &lt;!-- site level provision START --&gt;
    &lt;add key="ShouldDeployTaxonomy" value="false" /&gt;

    &lt;add key="ShouldDeploySandboxSolutions" value="false" /&gt;

    &lt;add key="ShouldDeploySiteFeatures" value="false" /&gt;
    &lt;add key="ShouldDeploySiteSecurity" value="false" /&gt;
    &lt;add key="ShouldDeployFieldsAndContentTypes" value="false" /&gt;

    &lt;!-- site level provision END --&gt;

    &lt;!-- root web level provision START --&gt;

    &lt;add key="ShouldDeployRootWeb" value="false" /&gt;
    &lt;add key="ShouldDeployStyleLibrary" value="false" /&gt;

    &lt;!-- root web level provision END --&gt;

    &lt;!-- sub webs level provision START --&gt;

    &lt;add key="ShouldDeployFinanceWeb" value="false" /&gt;
    &lt;add key="ShouldDeploySalesWeb" value="false" /&gt;
    &lt;add key="ShouldDeployTesmsWeb" value="false" /&gt;

    &lt;!-- sub webs level provision END --&gt;

  &lt;/appSettings&gt;
</code></pre>
<p>App configuration can be auto-generated with the T4 template. Just use "Add new item -&gt; SPMeta2 -&gt; AppSettings", name it as 'AppSetting' and click 'Ok':</p>
<img src="_img/m2console.appsettingsitem.png" class=" img-thumbnail img-responsive">
<p>A new file 'AppSetting.tt' will be added to your solution:</p>
<img src="_img/m2console.appsettingsitemt4.png" class=" img-thumbnail img-responsive">
<p>Once file is opened and saved, a corresponding *.cs file with the class names 'AppSetting' is generated. All properties are driven by the app.config with the following naming convention:</p>
<ul>
<li>ShouldXXX -&gt; cobverted to boolen props</li>
<li>XXXCount -&gt; converted to integer</li>
<li>the rest -&gt; converted to strings</li>
</ul>
<img src="_img/m2console.appsettingsitemt4generation.png" class=" img-thumbnail img-responsive">
<p>Altogether, the console project template, pre-generated utils, app.config and T4 config item template help to bootstrap the basic provision console application in a few clicks.</p>



            

    <div class="m-prevNextNav-cnt">
            <a class="btn-lg btn-default m-btn-prev" href="/spmeta2-vs/getting-started/intranetmodelprojecttemplate.html">
                <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span> Previous
            </a>
                    <a class="btn-lg btn-default pull-right m-btn-next" href="/spmeta2-vs/getting-started/snippets.html">
                Next <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
            </a>
    </div>

        </div>

        

    </div>
</div>


        <footer class="footer dark-bg" id="footer">
    <div class="container">
        <div class="wrapper-lg">
            <div class="row">
                <!-- Footer Left Col -->
                <div class="col-md-4">
                    <!-- Logo -->


                    <h5 class="text-white">
                        <img src="/content/img/subpoint-logo-25.png" alt="Logo" class=" img-thumbnail img-responsive">
                        SubPoint Solutions
                    </h5>

                    <p class="footer-hero">
                        Enhancing your SharePoint experience with excellent APIs, products, and services so that you can focus on business-critical tasks.
                        Recognized and trusted since 2013.
                    </p>
                </div>
                <!-- Footer Contact Col -->
                <div class="col-md-4">
                    <h5 class="text-white">Our Contacts</h5>
                    <div class="contact-item">
                        <div class="contact-content">
                            Email:<br>
                            <a style="font-size: 14px;" href="mailto:support@subpointsolutions.com">support@subpointsolutions.com</a>
                        </div>

                        <div class="contact-content">
                            Yammer Network:<br>
                            <a style="font-size: 14px;" href="https://www.yammer.com/spmeta2feedback" target="_blank">https://www.yammer.com/spmeta2feedback</a>
                        </div>


                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="icon icon_pin"></i>
                        </div>
                        <div class="contact-content">
                            Sydney, NSW 2000 Australia
                        </div>
                    </div>
                </div>
                <!-- Footer Right Col: Twitter Feed -->
                <div class="col-md-4">
                    <h5 class="text-white">Recent Tweets</h5>

                    <div class="tweet" id="twitter-cnt">

                    </div>
                </div>

                <!-- Footer Menu and Copy -->
               
            </div>

            <div class="row">
                <div class="col-md-12">
                    <ul class="footer-nav">
                        <li>
                            <a href="/company">Company</a>
                        </li>
                        
                        <li>
                            <a href="/terms">Terms Of Use</a>
                        </li>
                        <li>
                            <a href="/privacy">Privacy Policy</a>
                        </li>
                    </ul>
                    <p class="footer-copy">

                        Copyright © <a hre="http://subpointsolutions.com" target="_blank">SubPoint Solutions</a> 2017. 
                        Built with care, <a href="http://wyam.io" target="_blank">Wyam</a> and <a href="https://www.netlify.com/" target="_blank">Netlify</a>. Last updated Sun, 30 Apr 2017 21:59:18 GMT.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

    </div>

    <script src="/scripts/jquery-1.9.1.min.js"></script>
    <script src="/scripts/bootstrap.js"></script>

    <script src="/scripts/syntaxhighlighter/shcore.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushcsharp.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushxml.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushjscript.js"></script>
    <script src="/scripts/syntaxhighlighter/shbrushpowershell.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script>


    

    


    <script>

        (function ($) {

            $(document).ready(function () {

                $('code.language-cs')
                    .addClass('brush: csharp;');

                $('code.language-xml')
                    .addClass('brush: xml;');

                $('code.language-js')
                    .addClass('brush: js;');
                    
                $('code.language-ps')
                       .addClass('brush: ps;');

                SyntaxHighlighter.defaults['quick-code'] = false;
                SyntaxHighlighter.config.tagName = 'code';
                SyntaxHighlighter.all();
            });

            $(document).ready(function () {
                $("body").bind("keydown", function (event) {

                    console.log(event);

                    if (event.ctrlKey && event.keyCode == 37) {

                        if ($('a.m-btn-prev').size() > 0) {
                            var href = $('a.m-btn-prev').attr('href');

                            window.location.href = href;
                        }
                    }

                    if (event.ctrlKey && event.keyCode == 39) {
                        if ($('a.m-btn-next').size() > 0) {
                            var href = $('a.m-btn-next').attr('href');

                            window.location.href = href;
                        }
                    }
                });
            });

        }(jQuery));

    </script>


</body></html>